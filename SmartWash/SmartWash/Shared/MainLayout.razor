@inherits LayoutComponentBase
@using MudBlazor
@using SmartWash.Domain.Entities
@using Microsoft.AspNetCore.Identity

@inject NavigationManager NavigationManager
@inject SignInManager<ApplicationUser> SignInManager

<PageTitle>Smart Wash</PageTitle>

<SmartWashThemeProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>

    <MudAppBar Fixed="false" Elevation="1">
        <MudSpacer/>
            <MudButton Link="/">Home</MudButton>
            <MudButton Link="/about">About</MudButton>
        <AuthorizeView Roles="Member, Admin">
            <NotAuthorized>
                <MudButton Link="/Account/Login">Login</MudButton>
                <MudButton Link="/Account/SignUp">Sign Up</MudButton>
            </NotAuthorized>
            <Authorized>
                <MudButton Style="margin-right: 20px" OnClick="SignOutUser">Logout</MudButton>
                <AuthorizeView Roles="Member">
                    <Authorized Context="anotherig">
                        <MudMenu>
                            <ActivatorContent>
                                <MudAvatar Color="Color.Primary">@context.User.Identity?.Name?[0].ToString().ToUpper()</MudAvatar>
                            </ActivatorContent>
                            <ChildContent>
                                <MudMenuItem Link="/Account/UserFeedback">Write Feedback</MudMenuItem>
                                <MudMenuItem Link="/Account/FeedbackList">View Feedbacks</MudMenuItem>
                                <MudMenuItem>Bookings</MudMenuItem>
                                <MudMenuItem>Cameras</MudMenuItem>
                            </ChildContent>
                        </MudMenu>
                    </Authorized>

                    <NotAuthorized Context="haha">
                        <MudMenu>
                            <ActivatorContent>
                                    <MudAvatar Color="Color.Primary">@context.User.Identity?.Name?[0].ToString().ToUpper()</MudAvatar>
                                </ActivatorContent>
                            <ChildContent>
                                <MudMenuItem Link="/Account/AdminFeedbackList">User Feedback</MudMenuItem>
                                <MudMenuItem>Cameras</MudMenuItem>
                            </ChildContent>
                        </MudMenu>
                    </NotAuthorized>
                </AuthorizeView>
            </Authorized>
        </AuthorizeView>
    </MudAppBar>

    <MudMainContent Style="padding: 0;">
        <MudContainer MaxWidth="MaxWidth.False" Style="padding: 0;">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    public async Task SignOutUser()
    {
        NavigationManager.NavigateTo("/Account/SignOut");
    }


}



